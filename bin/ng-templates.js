"use strict";var fs=require("fs");var glob=require("glob");var minify=require("html-minifier").minify;module.exports = function templatize(path){var options=arguments.length <= 1 || arguments[1] === undefined?{}:arguments[1];if(!options.moduleName){options.moduleName = "templates";}if(typeof options.name != "function"){options.name = function(filename){return filename;};}var paths=path;if(!Array.isArray(paths)){paths = [path];}return new Promise(function(mainResolve,mainReject){var globPromises=[];var templateCache="angular.module(\"" + options.moduleName + "\").run([ \"$templateCache\", function($templateCache) {\n\tuse strict;";paths.forEach(function(filePath){globPromises.push(new Promise(function(globResolve){glob(filePath,function(err,files){if(err){return mainReject(err);}var filePromises=[];files.forEach(function(file){filePromises.push(new Promise(function(fhResolve,fhReject){fs.readFile(file,{encoding:"utf8"},function(fhErr,html){if(fhErr){return fhReject(fhErr);}var minified=minify(html,{removeComments:true,collapseWhitespace:true,quoteCharacter:"'"});minified = minified.replace(/"/g,"\\\"");minified = "$templateCache.put(\"" + options.name(file) + "\", \"" + minified + "\");";templateCache += "\n\t" + minified;fhResolve();});}));});Promise.all(filePromises).then(globResolve);});}));});Promise.all(globPromises).then(function(){templateCache += "\n}]);";mainResolve(templateCache);});});};